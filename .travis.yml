sudo: required
dist: xenial
language: cpp

env:
  - ARMADILLO=latest
  - ARMADILLO=minimum

before_install:
  - sudo apt-get update -qq
  - sudo add-apt-repository -y ppa:boost-latest/ppa
  - sudo apt-get update
  - travis_wait 30 sudo apt-get install -qq libopenblas-dev liblapack-dev g++ libboost-all-dev
  - if [ $ARMADILLO == "latest" ]; then
      curl https://ftp.fau.de/macports/distfiles/armadillo/`curl https://ftp.fau.de/macports/distfiles/armadillo/ -- | grep '.tar.xz' | sed 's/^.*<a href="\(armadillo-[0-9]*.[0-9]*.[0-9]*.tar.xz\)".*$/\1/' | tail -1` | tar xvJ && cd armadillo*;
    fi
  - if [ $ARMADILLO == "minimum" ]; then
      curl https://ftp.fau.de/macports/distfiles/armadillo/armadillo-8.400.0.tar.xz | tar -xvJ && cd armadillo*;
    fi
  - cmake . && make && sudo make install && cd ..
  - cd $TRAVIS_BUILD_DIR && cd .. && git clone https://github.com/mlpack/mlpack.git --depth 1
  - cd mlpack && mkdir build && cd build && cmake .. && make -j2 && sudo make install
  
install:
  - cd $TRAVIS_BUILD_DIR && mkdir build && cd build && cmake ..
script:
  - make -j2
  - travis_wait 30
notifications:
  email:
    - mlpack-git@lists.mlpack.org
  irc:
    channels:
      - "chat.freenode.net#mlpack"
    on_success: change
on_failure: always
